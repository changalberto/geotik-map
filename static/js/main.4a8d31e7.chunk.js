(this.webpackJsonpgeotik=this.webpackJsonpgeotik||[]).push([[0],{103:function(t,e){},138:function(t,e){},162:function(t,e){},309:function(t,e,a){},314:function(t,e){},315:function(t,e,a){},316:function(t,e,a){},317:function(t,e,a){"use strict";a.r(e);var l=a(0),n=a.n(l),i=a(169),o=a.n(i),c=(a(309),a(52));const{REACT_APP_MAPBOX_TOKEN:s}=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_MAPBOX_TOKEN:"pk.eyJ1IjoiY2hhbmdhbGJlcnRvIiwiYSI6ImNreGZzZDFtZjQxM3EzMG8xdDhqenZ1NWgifQ.kp3YAc0jNtBBj4chlTJyCw"}),r=s;var d=a.p+"static/media/annotatedData.1c0147e5.geojson";var u=a(173),p=a(334),b=a(143),h=a(183),f=a(327),j=a(328),g=a(179),m=a(105);const v=(t=0,e=10)=>Object(m.a)().domain([0,e]).range([[255,217,217],[255,124,10]])(t);var O=a(14);const x=new u.a({color:[255,255,255],intensity:1}),y=new p.a({timestamp:Date.UTC(2019,7,1,22),color:[255,255,255],intensity:1,_shadow:!0}),k={ambient:.64,diffuse:.6,shininess:32,specularColor:[51,51,51]},A={latitude:38.895,longitude:-77.0366,zoom:11,minZoom:8,pitch:55,bearing:0},w=({data:t,token:e,width:a,height:n,selectedFeatureId:i,selectedYear:o,onPolygonClick:s,...r})=>{const d=Math.max(...[...null===t||void 0===t?void 0:t.features].map((({properties:t})=>t.total))),u=t=>Object(c.isNull)(t)?"N/A":t,p=[new f.a({id:"flat-polygons-layer",data:t,opacity:.8,stroked:!0,filled:!0,extruded:!1,wireframe:!0,getElevation:0,getFillColor:({properties:t})=>v(null===t||void 0===t?void 0:t.total,d),getLineColor:[0,0,0],pickable:!0,onClick:t=>s(t)}),!Object(c.isNull)(i)&&new f.a({id:"extruded-polygons-layer",data:(e=>{const{features:a}=t;return{...t,features:[a.find((({id:t})=>t===e))]}})(i),opacity:.7,stroked:!1,filled:!0,extruded:!0,wireframe:!0,getElevation:({properties:t})=>60*Math.max(o&&"null"!==o?null===t||void 0===t?void 0:t[o]:(null===t||void 0===t?void 0:t.total)||0,1),getFillColor:({properties:t})=>v(null===t||void 0===t?void 0:t.total,d),getLineColor:[0,0,0],material:k,pickable:!0})],[m]=Object(l.useState)((()=>{const t=new b.a({ambientLight:x,dirLight:y});return t.shadowColor=[0,0,0,.5],[t]}));return Object(O.jsx)(j.a,{initialViewState:{...A},layers:p,effects:m,controller:!0,getTooltip:({object:t})=>{if(t){const{properties:e}=t;return{html:'\n          <div style="font-size: 16px; margin-bottom: 7px;"><b>'.concat(e.name,"</b> (").concat(u(e.total),')</div>\n          <div style="font-size: 12px;"><b>2010</b>: ').concat(u(e[2010]),'</div>\n          <div style="font-size: 12px;"><b>2011</b>: ').concat(u(e[2011]),'</div>\n          <div style="font-size: 12px;"><b>2012</b>: ').concat(u(e[2012]),'</div>\n          <div style="font-size: 12px;"><b>2013</b>: ').concat(u(e[2013]),'</div>\n          <div style="font-size: 12px;"><b>2014</b>: ').concat(u(e[2014]),"</div>\n        ")}}return null},children:Object(O.jsx)(h.a,{id:"map",width:a,controller:!0,children:Object(O.jsx)(g.a,{mapStyle:"mapbox://styles/mapbox/light-v10",reuseMaps:!0,mapboxApiAccessToken:e,preventStyleDiffing:!0})})})};w.defaultProps={width:"100%",height:"100vh",selectedFeatureId:null,selectedYear:null,onPolygonClick:t=>{}};var C=w,S=a(63),P=a(141),I=a.n(P);const M=({width:t,height:e,innerRadius:a,data:n,selectedFeatureId:i,selectedYear:o,onStackSelected:c,...s})=>{const[r,d]=Object(l.useState)(null),u=Math.min(t,e)/2,p=Object(l.useMemo)((()=>[2010,2011,2012,2013,2014]),[]),b=Object(l.useMemo)((()=>n.map((({id:t,properties:e})=>({id:t,label:e.name,...p.reduce(((t,a)=>({...t,[a]:I()(e[a])?0:e[a]})),{}),total:I()(e.total)?0:e.total})))),[n,p]),h=S.c().domain(b.map((t=>t.label))).range([0,2*Math.PI]).align(0),f=S.e().domain([0,S.b(b,(t=>t.total))]).range([a,u]),j=S.d().domain(p).range(["#98abc5","#8a89a6","#7b6888","#d0743c","#ff8c00"]),g=S.a().innerRadius((t=>f(t[0]))).outerRadius((t=>f(t[1]))).startAngle((t=>h(t.data.label))).endAngle((t=>h(t.data.label)+h.bandwidth())).padAngle(.01).padRadius(a);Object(l.useEffect)((()=>{!r&&m()}),[]),Object(l.useEffect)((()=>{if(r){if(!i)return void r.selectAll("path").style("opacity",1);const t="class-".concat(i);r.selectAll("path.".concat(t)).style("opacity",1),r.selectAll("path:not(.".concat(t,")")).style("opacity",.3)}}),[r,i]);const m=()=>{const a=S.f(".radial-stacked-bars").append("svg").attr("width",t).attr("height",e).attr("viewBox","".concat(-t/2," ").concat(-e/2," ").concat(t," ").concat(e)).style("width","100%").style("height","auto").style("margin","auto").style("font","10px sans-serif");v(a),a.append("g").call(x),a.append("g").call(k),y(a),d(a)},v=t=>{const e=S.g().keys(p)(b);t.append("g").selectAll("g").data(e).join("g").attr("fill",(t=>j(t.key))).selectAll("path").data((t=>t)).join("path").attr("class",(t=>"class-".concat(t.data.id))).attr("data-id",(t=>t.data.id)).attr("d",g).on("click",(function(e){var a;const l=null===(a=this.className)||void 0===a?void 0:a.baseVal,n=this.getAttribute("data-id");t.selectAll("path.".concat(l)).style("opacity",1),t.selectAll("path:not(.".concat(l,")")).style("opacity",.3),c(n)}))},x=t=>t.attr("text-anchor","middle").call((t=>t.append("text").attr("y",(t=>-f(f.ticks(5).pop()))).attr("dy","-1em").attr("fill","#666").style("font","bold 16px sans-serif").attr("stroke","#fff").attr("stroke-linejoin","round").attr("stroke-width",1).text("Accidents"))).call((t=>t.selectAll("g").data(f.ticks(5).slice(1)).join("g").attr("fill","none").call((t=>t.append("circle").attr("stroke","#999").attr("stroke-opacity",.5).attr("r",f))).call((t=>t.append("text").attr("y",(t=>-f(t))).attr("dy","0.35em").attr("stroke","#fff").attr("stroke-width",5).text(f.tickFormat(5,"s")).clone(!0).attr("fill","#999").attr("stroke","none"))))),y=t=>{t.append("g").selectAll("g").data(b).enter().append("g").attr("text-anchor",(function(t){return(h(t.label)+h.bandwidth()/2+Math.PI)%(2*Math.PI)<Math.PI?"end":"start"})).attr("transform",(function(t){return"rotate("+(180*(h(t.label)+h.bandwidth()/2)/Math.PI-90)+")translate("+(f(t.total)+10)+",0)"})).append("text").text((function(t){return t.label})).attr("transform",(function(t){return(h(t.label)+h.bandwidth()/2+Math.PI)%(2*Math.PI)<Math.PI?"rotate(180)":"rotate(0)"})).style("font-size","11px").attr("alignment-baseline","middle")},k=t=>t.append("g").selectAll("g").data(p.reverse()).join("g").attr("transform",((t,e)=>"translate(-20,".concat(20*(e-(p.length-1)/2),")"))).call((t=>t.append("rect").attr("width",16).attr("height",18).attr("fill",j))).call((t=>t.append("text").attr("x",24).attr("y",9).attr("dy","0.35em").text((t=>t))));return Object(O.jsx)("div",{className:"radial-stacked-bars"})};M.defaultProps={width:800,height:800,innerRadius:180,onStackSelected:t=>{}};var N=M;a(315);const E=({label:t,name:e,options:a,placeholder:n,onChange:i,selected:o,disabled:c,...s})=>{const r=Object(l.useMemo)((()=>a.map((({value:t,label:e})=>Object(O.jsx)("option",{value:"".concat(t),children:e},t)))),[a]);return Object(O.jsxs)("div",{className:"select",children:[t&&Object(O.jsx)("label",{children:t}),Object(O.jsxs)("select",{name:e,onChange:t=>{i(t.target.value)},...c?{disabled:c}:{},value:"".concat(o),children:[n&&Object(O.jsx)("option",{disabled:!0,children:n}),r]})]})};E.defaultProps={name:"[name]",options:[],onChange:()=>{}};var _=E;a(316);var T=function(){const[t,e]=Object(l.useState)(null),[a,n]=Object(l.useState)(null),[i,o]=Object(l.useState)(null);Object(l.useEffect)((()=>{(async()=>{const t=await class{static async getImparedVehicles(){return await fetch(d).then((t=>t.json())).then((t=>t))}}.getImparedVehicles();e(t)})()}),[]);const s=Object(l.useCallback)((e=>{if(!Object(c.isNull)(e)){const{features:e}=t,l=e.find((({id:t})=>t===a));if(!Object(c.isEmpty)(l)){const{properties:t}=l;return[{value:null,label:"All"},...Object.keys(t).filter((t=>t.startsWith("20"))).map((t=>({value:t,label:t})))]}}return[{value:null,label:"All"}]}),[t,a]),u=t=>{n(t?+t:null),o(null)},p=Object(l.useMemo)((()=>{if(t){const{features:e}=t;return[{value:null,label:"All"},...e.map((({id:t,properties:e})=>({value:t,label:null===e||void 0===e?void 0:e.name})))]}}),[t]),b=Object(l.useMemo)((()=>s(a)),[s,a]);return Object(O.jsxs)("div",{className:"App",children:[Object(O.jsx)("div",{className:"map",children:t&&Object(O.jsx)(C,{data:t,width:"100%",height:"100%",token:r,selectedFeatureId:a,selectedYear:i,onPolygonClick:({object:{id:t}})=>{n(t)}})}),Object(O.jsxs)("aside",{children:[Object(O.jsxs)("header",{children:[Object(O.jsx)("h1",{children:"Impared Car Accidents"}),Object(O.jsx)("em",{children:"Washington DC, 2010-2014"})]}),Object(O.jsxs)("div",{className:"filter-group",children:[p&&Object(O.jsx)(_,{label:"Neighborhood",name:"neighborhood",options:p,onChange:u,selected:a}),p&&Object(O.jsx)(_,{label:"Year",name:"year",options:b,onChange:t=>o(t),selected:i,disabled:Object(c.isNull)(a)}),Object(O.jsx)("button",{className:"button filter-group__clear-button",disabled:Object(c.isNull)(a)&&Object(c.isNull)(a),onClick:t=>{t.preventDefault(),n(null),o(null)},children:"Clear All"})]}),t&&Object(O.jsx)(N,{data:null===t||void 0===t?void 0:t.features,selectedFeatureId:a,selectedYear:i,onStackSelected:u})]})]})};var F=t=>{t&&t instanceof Function&&a.e(3).then(a.bind(null,336)).then((({getCLS:e,getFID:a,getFCP:l,getLCP:n,getTTFB:i})=>{e(t),a(t),l(t),n(t),i(t)}))};o.a.render(Object(O.jsx)(n.a.StrictMode,{children:Object(O.jsx)(T,{})}),document.getElementById("root")),F()}},[[317,1,2]]]);
//# sourceMappingURL=main.4a8d31e7.chunk.js.map